# Segurança e Autenticação (20 Tarefas)

96. "No modo Code, implemente JWT em `app/core/security.py` com funções `create_access_token()` e `verify_token()`."
97. "No modo Code, gere um arquivo `app/api/endpoints/auth.py` com rota `POST /auth/login` para autenticação JWT."
98. "No modo Code, adicione ao `app/core/config.py` variáveis `SECRET_KEY`, `ALGORITHM`, `ACCESS_TOKEN_EXPIRE_MINUTES`."
99. "No modo Code, crie um middleware em `app/middleware/auth.py` para validar JWT em rotas protegidas."
100. "No modo Code, gere um arquivo `app/schemas/token.py` com modelos Pydantic para `Token` e `TokenData`."
101. "No modo Code, implemente hash de senhas em `app/core/security.py` usando `bcrypt` ou `passlib`."
102. "No modo Code, adicione ao `app/api/endpoints/auth.py` rota `POST /auth/register` para registro de novos usuários."
103. "No modo Code, crie um arquivo `app/utils/oauth2.py` com suporte a OAuth2 para integração com redes sociais."
104. "No modo Code, gere um arquivo `app/services/auth_service.py` com funções `authenticate_user()` e `get_current_user()`."
105. "No modo Code, adicione proteção CORS em `app/main.py` com origens permitidas configuráveis."
106. "No modo Code, implemente rate limiting em `app/middleware/rate_limiter.py` usando `Redis`."
107. "No modo Code, gere um arquivo `app/utils/input_sanitizer.py` para sanitização de inputs contra XSS/SQLi."
108. "No modo Code, adicione headers de segurança HTTP em `app/middleware/security_headers.py`."
109. "No modo Code, implemente auditoria de logs em `app/utils/audit_logger.py` para registrar atividades sensíveis."
110. "No modo Code, gere um arquivo `scripts/rotate_keys.sh` para rotação periódica de chaves JWT."
111. "No modo Code, adicione verificação de permissões em `app/middleware/permissions.py` para controle de acesso."
112. "No modo Code, implemente 2FA em `app/services/auth_service.py` usando TOTP (ex.: pyotp)."
113. "No modo Code, gere um arquivo `app/utils/ip_restriction.py` para restringir acesso por IP quando aplicável."
114. "No modo Code, adicione ao `app/core/config.py` configurações para política de senhas (complexidade, expiração)."
115. "No modo QA, execute testes de segurança básicos (SQLi, XSS) e verifique headers de resposta."